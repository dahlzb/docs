import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,e}from"./app-BX-M_jOY.js";const t={},p=e(`<h2 id="sqlserver常用语句" tabindex="-1"><a class="header-anchor" href="#sqlserver常用语句"><span>SqlServer常用语句</span></a></h2><h4 id="修改字段的部分数据" tabindex="-1"><a class="header-anchor" href="#修改字段的部分数据"><span>修改字段的部分数据</span></a></h4><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> TableName <span class="token keyword">SET</span> 字段名 <span class="token operator">=</span> <span class="token keyword">REPLACE</span><span class="token punctuation">(</span>字段名<span class="token punctuation">,</span><span class="token string">&#39;字段中修改前的数据&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;字段中修改后的数据&#39;</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span> 字段名 <span class="token operator">like</span> <span class="token string">&#39;%字段中修改前的数据%&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="添加列" tabindex="-1"><a class="header-anchor" href="#添加列"><span>添加列</span></a></h4><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">ADD</span> 列名 数据类型 是否为<span class="token boolean">NULL</span> 默认值
<span class="token comment">-- 添加列</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>AdvancePaymentOrders<span class="token punctuation">]</span> <span class="token keyword">ADD</span> ServiceOrganName nvarchar<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span>
<span class="token comment">-- 修改列</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>AdvancePaymentOrders<span class="token punctuation">]</span> <span class="token keyword">ALTER</span> <span class="token keyword">COLUMN</span> ServiceOrganName nvarchar<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token comment">-- 删除列</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>AdvancePaymentOrders<span class="token punctuation">]</span> <span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> <span class="token punctuation">[</span>ProxyMerchantId<span class="token punctuation">]</span>
<span class="token comment">-- 删除表格</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>AuthPayMerchants<span class="token punctuation">]</span>
<span class="token comment">-- 删除视图</span>
<span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>V_MerchantsAuthPay<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="定义变量" tabindex="-1"><a class="header-anchor" href="#定义变量"><span>定义变量</span></a></h4><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@UserId</span> uniqueidentifier
<span class="token keyword">SELECT</span> <span class="token variable">@UserId</span> <span class="token operator">=</span> UserId <span class="token keyword">FROM</span> <span class="token punctuation">[</span>YJY31<span class="token punctuation">.</span>Users<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>UserThirdAccounts<span class="token punctuation">]</span> <span class="token keyword">WHERE</span> ThirdAccount <span class="token operator">=</span> <span class="token string">&#39;2088012569981173&#39;</span>
<span class="token keyword">DELETE</span> <span class="token punctuation">[</span>YJY31<span class="token punctuation">.</span>Users<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>UserThirdAccounts<span class="token punctuation">]</span> <span class="token keyword">WHERE</span> UserId <span class="token operator">=</span> <span class="token variable">@UserId</span>
<span class="token keyword">DELETE</span> <span class="token punctuation">[</span>YJY31<span class="token punctuation">.</span>Users<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Users<span class="token punctuation">]</span> <span class="token keyword">WHERE</span> UserId <span class="token operator">=</span> <span class="token variable">@UserId</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="存储过程" tabindex="-1"><a class="header-anchor" href="#存储过程"><span>存储过程</span></a></h4><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Proc_StatisticsScsyyServiceVolume<span class="token punctuation">]</span> 
	<span class="token comment">-- Add the parameters for the stored procedure here</span>
	<span class="token variable">@BeginTime</span> <span class="token keyword">datetime</span><span class="token punctuation">,</span>
	<span class="token variable">@EndTime</span> <span class="token keyword">datetime</span>
<span class="token keyword">AS</span>
<span class="token keyword">BEGIN</span>
	<span class="token comment">-- SET NOCOUNT ON added to prevent extra result sets from</span>
	<span class="token comment">-- interfering with SELECT statements.</span>
	<span class="token keyword">DECLARE</span> <span class="token variable">@ImgTextInquiryPrescriptionOrderQuantity</span> <span class="token keyword">int</span>
	<span class="token keyword">DECLARE</span> <span class="token variable">@ImgTextInquiryOrderQuantity</span> <span class="token keyword">int</span>
	
	<span class="token keyword">SET</span> NOCOUNT <span class="token keyword">ON</span><span class="token punctuation">;</span>

	<span class="token comment">-- 图文问诊可开方</span>
	<span class="token keyword">SELECT</span> <span class="token variable">@ImgTextInquiryPrescriptionOrderQuantity</span> <span class="token operator">=</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>YJY31<span class="token punctuation">.</span>Orders<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Orders<span class="token punctuation">]</span> <span class="token keyword">AS</span> O
	<span class="token keyword">WHERE</span> O<span class="token punctuation">.</span>GoodsOrderState <span class="token operator">=</span> <span class="token number">20</span>

	<span class="token comment">-- 图文问诊</span>
	<span class="token keyword">SELECT</span> <span class="token variable">@ImgTextInquiryOrderQuantity</span> <span class="token operator">=</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>YJY31<span class="token punctuation">.</span>Orders<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Orders<span class="token punctuation">]</span> <span class="token keyword">AS</span> O
	<span class="token keyword">WHERE</span> O<span class="token punctuation">.</span>GoodsOrderState <span class="token operator">=</span> <span class="token number">20</span> 

	<span class="token keyword">SELECT</span> <span class="token variable">@ImgTextInquiryPrescriptionOrderQuantity</span> <span class="token keyword">as</span> ImgTextInquiryPrescriptionOrderQuantity<span class="token punctuation">,</span>
	<span class="token variable">@ImgTextInquiryOrderQuantity</span> <span class="token keyword">as</span> ImgTextInquiryOrderQuantity
<span class="token keyword">END</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="游标" tabindex="-1"><a class="header-anchor" href="#游标"><span>游标</span></a></h4><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@PaymentSerialNumber</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> 
<span class="token keyword">DECLARE</span> <span class="token variable">@RefundTime</span> datetime2 
<span class="token keyword">DECLARE</span> <span class="token variable">@PaymentTime</span> datetime2 
<span class="token comment">-- 定义游标</span>
<span class="token comment">-- 查出需要的集合放到游标中</span>
<span class="token keyword">DECLARE</span> My_Cursor <span class="token keyword">CURSOR</span> 
<span class="token keyword">FOR</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> PaymentSerialNumber <span class="token keyword">FROM</span> <span class="token punctuation">[</span>YJY31<span class="token punctuation">.</span>ProxyPay<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>RefundApply<span class="token punctuation">]</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> PaymentSerialNumber<span class="token punctuation">)</span> 
<span class="token comment">-- 打开游标</span>
<span class="token keyword">OPEN</span> My_Cursor<span class="token punctuation">;</span> 
<span class="token comment">-- 读取第一行数据(将MemberAccount表中的UserId放到@UserId变量中)</span>
<span class="token keyword">FETCH</span> <span class="token keyword">NEXT</span> <span class="token keyword">FROM</span> My_Cursor <span class="token keyword">INTO</span> <span class="token variable">@PaymentSerialNumber</span><span class="token punctuation">;</span> 
<span class="token keyword">WHILE</span> @<span class="token variable">@FETCH_STATUS</span> <span class="token operator">=</span> <span class="token number">0</span>
	<span class="token keyword">BEGIN</span>
		<span class="token comment">-- 打印数据</span>
		<span class="token keyword">PRINT</span> <span class="token variable">@PaymentSerialNumber</span><span class="token punctuation">;</span> 
		<span class="token keyword">SELECT</span> <span class="token variable">@PaymentTime</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>YJY31<span class="token punctuation">.</span>Orders<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Orders<span class="token punctuation">]</span> <span class="token keyword">where</span> <span class="token punctuation">[</span>PayOrderNumber<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">@PaymentSerialNumber</span>
		<span class="token keyword">if</span> <span class="token variable">@PaymentTime</span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
		<span class="token keyword">BEGIN</span>
			<span class="token keyword">UPDATE</span> <span class="token punctuation">[</span>YJY31<span class="token punctuation">.</span>ProxyPay<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>AdvancePaymentOrders<span class="token punctuation">]</span> <span class="token keyword">SET</span> PaymentCompleteTime <span class="token operator">=</span> <span class="token variable">@PaymentTime</span> <span class="token keyword">WHERE</span> PaymentSerialNumber <span class="token operator">=</span> <span class="token variable">@PaymentSerialNumber</span> 
		<span class="token keyword">END</span>
		<span class="token comment">-- 读取下一行数据</span>
		<span class="token keyword">FETCH</span> <span class="token keyword">NEXT</span> <span class="token keyword">FROM</span> My_Cursor <span class="token keyword">INTO</span> <span class="token variable">@PaymentSerialNumber</span><span class="token punctuation">;</span> 
	<span class="token keyword">END</span>
<span class="token comment">-- 关闭游标</span>
<span class="token keyword">CLOSE</span> My_Cursor<span class="token punctuation">;</span>
<span class="token comment">-- 释放游标</span>
<span class="token keyword">DEALLOCATE</span> My_Cursor<span class="token punctuation">;</span>
GO
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11),o=[p];function c(l,i){return s(),a("div",null,o)}const d=n(t,[["render",c],["__file","SqlServer常用语句.html.vue"]]),k=JSON.parse(`{"path":"/backend/database/SqlServer%E5%B8%B8%E7%94%A8%E8%AF%AD%E5%8F%A5.html","title":"SqlServer常用语句","lang":"zh-CN","frontmatter":{"title":"SqlServer常用语句","date":"2024-04-12T17:07:05.000Z","description":"SqlServer常用语句 修改字段的部分数据 添加列 定义变量 存储过程 游标","head":[["meta",{"property":"og:url","content":"https://dahlzb.github.io/docs/backend/database/SqlServer%E5%B8%B8%E7%94%A8%E8%AF%AD%E5%8F%A5.html"}],["meta",{"property":"og:site_name","content":"DahlZb小站"}],["meta",{"property":"og:title","content":"SqlServer常用语句"}],["meta",{"property":"og:description","content":"SqlServer常用语句 修改字段的部分数据 添加列 定义变量 存储过程 游标"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-22T11:57:08.000Z"}],["meta",{"property":"article:author","content":"DahlZb"}],["meta",{"property":"article:published_time","content":"2024-04-12T17:07:05.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-22T11:57:08.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"SqlServer常用语句\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-04-12T17:07:05.000Z\\",\\"dateModified\\":\\"2024-04-22T11:57:08.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"DahlZb\\",\\"url\\":\\"https://github.com/dahlzb\\"}]}"]]},"headers":[{"level":2,"title":"SqlServer常用语句","slug":"sqlserver常用语句","link":"#sqlserver常用语句","children":[]}],"git":{"createdTime":1713787028000,"updatedTime":1713787028000,"contributors":[{"name":"dahlzb","email":"1304187196@qq.com","commits":1}]},"readingTime":{"minutes":1.41,"words":423},"filePathRelative":"backend/database/SqlServer常用语句.md","localizedDate":"2024年4月12日","excerpt":"<h2>SqlServer常用语句</h2>\\n<h4>修改字段的部分数据</h4>\\n<div class=\\"language-sql\\" data-ext=\\"sql\\" data-title=\\"sql\\"><pre class=\\"language-sql\\"><code><span class=\\"token keyword\\">UPDATE</span> TableName <span class=\\"token keyword\\">SET</span> 字段名 <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">REPLACE</span><span class=\\"token punctuation\\">(</span>字段名<span class=\\"token punctuation\\">,</span><span class=\\"token string\\">'字段中修改前的数据'</span><span class=\\"token punctuation\\">,</span><span class=\\"token string\\">'字段中修改后的数据'</span><span class=\\"token punctuation\\">)</span> <span class=\\"token keyword\\">WHERE</span> 字段名 <span class=\\"token operator\\">like</span> <span class=\\"token string\\">'%字段中修改前的数据%'</span>\\n</code></pre></div>","autoDesc":true}`);export{d as comp,k as data};
